den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1,
options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
form1 <- cbind(IGC_Full_Estimate1[2,], IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[2,]-IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[9,]) %>% data.frame()
form2 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1,
options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
form1 <- cbind(IGC_Full_Estimate1[2,], IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[2,]-IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[9,]) %>% data.frame()
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1,
options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
#ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
qplot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",]) +
geom_abline(slope = ot[2], intercept = ot[1]) +
labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",])
abline(slope = ot[2], intercept = ot[1]) +
#labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
summary(lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",]))
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",])
abline(ot[2],ot[1])
#labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
summary(lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",]))
summary(aov(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",]))
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",])
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
load("IGC_data1.1.RData")
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
qplot(MG["omega",], MG["tau",]) +
geom_abline(slope = ot[2], intercept = ot[1]) +
labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
summary(lm(MG["omega",]~MG["tau",]))
summary(aov(MG["omega",]~MG["tau",]))
library(lme4)
library(Matrix)
data <- data.frame(MG)
scale0 <- colSums(MG[c(44:57, 60:73),]) # sum of 1 -> 2 and 2 -> 1
tau.encount <- colSums(MG[c(44:57, 60:73),]) * MG[1,]
data <- rbind(MG, scale0, tau.encount)
data <- data[c(1, 8, 28:41, 90, 91),]
library(lme4)
library(Matrix)
data <- data.frame(MG)
scale0 <- colSums(MG[c(44:57, 60:73),]) # sum of 1 -> 2 and 2 -> 1
tau.encount <- colSums(MG[c(44:57, 60:73),]) * MG[1,]
data <- rbind(MG, scale0, tau.encount)
data <- data[c(1, 8, 28:41, 90, 91),]
taucountmatrix <- MG[44:57,]+MG[60:73,]
scale0matrix <- taucountmatrix/MG[28:41,]
omegamatrix <- rbind(MG[8,], MG[8,], MG[8,], MG[8,],MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,])
rownames(omegamatrix) <- rownames(MG[12:25,])
rownames(scale0matrix) <- rownames(MG[12:25,])
rownames(taucountmatrix) <- rownames(MG[12:25,])
newmatrix=matrix(rep(1,14*45),nrow=14)
for(i in 1:14){
newmatrix[i,]=scale0matrix[i,]/MG[1,]
}
newmatrix=newmatrix/MG[12:25,]
genenamesmatrix <- rbind(colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix) )
branchnamesmatrix <- cbind(rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix))
taucountvector <- c(taucountmatrix)
scale0vector <- c(scale0matrix)
omegavector <- c(omegamatrix)
genenamesvector <- c(genenamesmatrix)
branchnamesvector <- c(branchnamesmatrix)
data=data.frame(IGCevent=taucountvector,scale0=log(scale0vector),omega=omegavector,genename=genenamesvector,
branchname=branchnamesvector, seqdiff=c(newmatrix ))
library(lme4)
glm(round(IGCevent)~scale0+genename+seqdiff+seqdiff*genename,data=data,family = "poisson")
glm(IGCevent~scale0+branchname+genename,data=data,family = poisson)
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
load("IGC_data1.4.RData")
datatable(form1,
options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
load("IGC_data1.4.RData")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_Estimate1 <- Readin(NameList, "", "IGC_Full_Estimate1")
IGC_Full_ForceTau1 <- ReadinF(NameList,"", "IGC_Full_ForceTau1")
IGC_Full_Estimate2 <- Readin(NameList, "", "IGC_Full_Estimate2")
IGC_Full_ForceTau2 <- ReadinF(NameList,"", "IGC_Full_ForceTau2")
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
IGC_Full_force_noclock <- ReadinF(NameList, "", "IGC_Full_force_noclock")
form1 <- cbind(IGC_Full_Estimate1[2,], IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[2,]-IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[9,]) %>% data.frame()
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",])
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5])
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
plot(MG["omega",], MG["tau",])
abline(lm(MG["tau",]~MG["omega",])) +
#labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
summary(lm(MG["omega",]~MG["tau",]))
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
plot(MG["omega",], MG["tau",]) +
geom_abline(lm(MG["tau",]~MG["omega",])) +
labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
qplot(MG["omega",], MG["tau",]) +
geom_abline(lm(MG["tau",]~MG["omega",])) +
labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
plot(MG["omega",], MG["tau",])
abline(lm(MG["tau",]~MG["omega",]))
#labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
summary(lm(MG["omega",]~MG["tau",]))
summary(aov(MG["omega",]~MG["tau",]))
IGC_Full_noforce_noclock
IGC_Full_noforce_noclock[c(7,8,9),]
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
load("IGC_data1.4.RData")
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
#sort(form1[,5])
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
load("IGC_data1.4.RData")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_Estimate1 <- Readin(NameList, "", "IGC_Full_Estimate1")
IGC_Full_ForceTau1 <- ReadinF(NameList,"", "IGC_Full_ForceTau1")
IGC_Full_Estimate2 <- Readin(NameList, "", "IGC_Full_Estimate2")
IGC_Full_ForceTau2 <- ReadinF(NameList,"", "IGC_Full_ForceTau2")
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
IGC_Full_force_noclock <- ReadinF(NameList, "", "IGC_Full_force_noclock")
form1 <- cbind(IGC_Full_Estimate1[2,], IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[2,]-IGC_Full_ForceTau1[2,], IGC_Full_Estimate1[9,]) %>% data.frame()
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
#sort(form1[,5])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5])
sort(IGC_Full_noforce_noclock["tau",])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
sort(IGC_Full_noforce_noclock["tau",])
sort(IGC_Full_noforce_noclock["tau",])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
sort(IGC_Full_noforce_noclock["tau",])
IGC_Full_noforce_noclock[,"MG3994"]
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5])
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
load("IGC_data1.1.RData")
library(lme4)
library(Matrix)
data <- data.frame(IGC_Full_noforce_noclock)
scale0 <- colSums(IGC_Full_noforce_noclock[c(44:57, 60:73),]) # sum of 1 -> 2 and 2 -> 1
tau.encount <- colSums(IGC_Full_noforce_noclock[c(44:57, 60:73),]) * IGC_Full_noforce_noclock[1,]
data <- rbind(IGC_Full_noforce_noclock, scale0, tau.encount)
data <- data[c(1, 8, 28:41, 90, 91),]
library(lme4)
library(Matrix)
data <- data.frame(IGC_Full_noforce_noclock)
scale0 <- colSums(IGC_Full_noforce_noclock[c(44:57, 60:73),]) # sum of 1 -> 2 and 2 -> 1
tau.encount <- colSums(IGC_Full_noforce_noclock[c(44:57, 60:73),]) * IGC_Full_noforce_noclock[1,]
data <- rbind(IGC_Full_noforce_noclock, scale0, tau.encount)
data <- data[c(1, 8, 28:41, 90, 91),]
IGC_Full_noforce_noclock
IGC_Full_noforce_noclock[,1]
IGC_Full_noforce_noclock[12,1]
IGC_Full_noforce_noclock[25,1]
sum(IGC_Full_noforce_noclock[12:25,1])
IGC_Full_noforce_noclock[12:25,1]/sum(IGC_Full_noforce_noclock[12:25,1])
IGC_Full_force_noclock[12:25,1]/sum(IGC_Full_force_noclock[12:25,1])
plot(IGC_Full_noforce_noclock[12:25,1]/sum(IGC_Full_noforce_noclock[12:25,1]),IGC_Full_force_noclock[12:25,1]/sum(IGC_Full_force_noclock[12:25,1]))
plot(IGC_Full_noforce_noclock[12:25,2]/sum(IGC_Full_noforce_noclock[12:25,2]),IGC_Full_force_noclock[12:25,2]/sum(IGC_Full_force_noclock[12:25,2]))
View(IGC_Full)
save.image("~/Desktop/IGC_DATA/IGC_data1.5.RData")
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
load("IGC_data1.4.RData")
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
head(IGC_Full_noforce_noclock)
print(IGC_Full_noforce_noclock)
IGC_Full_noforce_noclock[,1]
View(IGC_Full)
proportion <- IGC_Full_noforce_noclock[11:25,]
proportion
proportion <- IGC_Full_noforce_noclock[11:25,] %>% t()
proportion
proportion <- IGC_Full_noforce_noclock[11:25,] / sum(IGC_Full_noforce_noclock[11:25,])
proportion
IGC_Full_noforce_noclock[11:25,1]/sum(IGC_Full_noforce_noclock[11:25,1])
proportion <- IGC_Full_noforce_noclock[11:25,] / colSum(IGC_Full_noforce_noclock[11:25,])
print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
proportion
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,]) %>% t() %>% as.data.frame()
print(proportion)
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])  %>% as.data.frame()
print(proportion)
proportion
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
print(proportion)
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,]) %>% as.data.frame()
print(proportion)
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
print(proportion)
IGC0 <- IGC_Full_noforce_noclock
IGC_Full_noforce_noclock
source('~/Desktop/IGC_DATA/simple_analysis.R', echo=TRUE)
tau.data
tau.data[,1]
matplot(tau1,type="b",lty=1,pch=1)
tau1
sort(tau1[3,])
head(tau.data)
summary(tau.gamma)
tau.data
source('~/Desktop/IGC_DATA/simple_analysis.R', echo=TRUE)
4^4
