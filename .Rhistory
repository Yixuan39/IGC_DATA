caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
NameList4Swap <- NameList4Swap[!(NameList4Swap %in% NameList4Swap[1])]
source('~/Desktop/IGC_DATA/ReadinUnit.R', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
source("ReadinUnit.R")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
IGC_Full_force_noclock <- ReadinF(NameList, "", "IGC_Full_force_noclock")
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
sort(IGC_Full_noforce_noclock["tau",])
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
print(proportion)
save.image("~/Desktop/IGC_DATA/Rdatas/IGC_data2.0.RData")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
load("inputFiles/IGC_data1.1.RData")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
load("Rdatas/IGC_data1.1.RData")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
#load("Rdatas/IGC_data1.1.RData")
load("Rdatas/IGC_data2.0.Rdata")
MG <- IGC_Full_noforce_noclock
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
#load("Rdatas/IGC_data1.1.RData")
load("Rdatas/IGC_data2.0.Rdata")
MG <- IGC_Full_noforce_noclock
col <- c("MG_ll", "MG_tau", "MG_Force_ll", "Difference")
difference <- MG["ll",] - MG_Forced["ll",]
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
#load("Rdatas/IGC_data1.1.RData")
load("Rdatas/IGC_data2.0.Rdata")
MG <- IGC_Full_noforce_noclock
MG_Forced <- IGC_Full_force_noclock
col <- c("MG_ll", "MG_tau", "MG_Force_ll", "Difference")
difference <- MG["ll",] - MG_Forced["ll",]
MG_Force_Form <- data.frame(MG["ll",], MG["tau",], MG_Forced["ll",], difference) # Difference is the difference between MG_ll with and without force tau
datatable(MG_Force_Form, colnames = col) %>%
formatRound( columns = 1:4 , 3) %>%
formatStyle('difference',
background = styleColorBar(MG_Force_Form$difference, 'lightblue'),
backgroundSize = '98% 88%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center')
qplot(MG["ll",], MG_Forced["ll",] ) + geom_abline(slope = 1, intercept = 0)
IGCchanges <- function(a, b, mutation){
num <- colSums(a) + colSums(b)
den <- num + colSums(mutation)
num/den
}
total <- IGCchanges(MG[c(44:57),], MG[c(60:73),], MG[c(76:89),]) %>% data.frame()
# 44:57 60:73 76:89
datatable(total, colnames = "proportion") %>%
formatRound( columns = 1 , 3)  %>%
formatStyle('.',
background = styleColorBar(total$., 'lightblue'),
backgroundSize = '98% 88%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center')
IGCchangesSep <- function(x, dataset){
one <- paste("(", x, ",1->2)",sep = "")
two <- paste("(", x, ",2->1)",sep = "")
mut <- paste("(", x, ",mut)",sep = "")
num <- dataset[one,] + dataset[two,]
den <- num + dataset[mut,]
num/den
}
N1N3 <- IGCchangesSep("N1,N3", MG)
N1N2 <- IGCchangesSep("N1,N2", MG)
N3N6 <- IGCchangesSep("N3,N6", MG)
N3N4 <- IGCchangesSep("N3,N4", MG)
N6N7 <- IGCchangesSep("N6,N7", MG)
N4N5 <- IGCchangesSep("N4,N5", MG)
N2ENSDARG <- IGCchangesSep("N2,ENSDARG", MG)
N2ENSAMXG <- IGCchangesSep("N2,ENSAMXG", MG)
N6ENSGACG <- IGCchangesSep("N6,ENSGACG", MG)
N4ENSONIG <- IGCchangesSep("N4,ENSONIG", MG)
N7ENSTRUG <- IGCchangesSep("N7,ENSTRUG", MG)
N7ENSTNIG <- IGCchangesSep("N7,ENSTNIG", MG)
N5ENSXMAG <- IGCchangesSep("N5,ENSXMAG", MG)
N5ENSORLG <- IGCchangesSep("N5,ENSORLG", MG)
IGC_List1 <- data.frame(N1N3, N1N2, N3N6, N3N4, N6N7, N4N5)
IGC_List2 <- data.frame(N2ENSDARG, N2ENSAMXG, N6ENSGACG, N4ENSONIG, N7ENSTRUG, N7ENSTNIG, N5ENSXMAG, N5ENSORLG)
datatable(IGC_List1, colnames = c("N1N3", "N1N2", "N3N6", "N3N4", "N6N7", "N4N5")) %>%
formatRound( columns = 1:6 , 3) %>%
formatStyle(colnames(IGC_List1)[1:ncol(IGC_List1)],
background = styleColorBar(IGC_List1$N1N3, 'lightblue'),
backgroundSize = '98% 88%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center')
datatable(IGC_List2, colnames = c("N2ENSDARG", "N2ENSAMXG", "N6ENSGACG", "N4ENSONIG", "N7ENSTRUG", "N7ENSTNIG", "N5ENSXMAG", "N5ENSORLG")) %>%
formatRound( columns = 1:8 , 3) %>%
formatStyle(colnames(IGC_List2)[1:ncol(IGC_List2)],
background = styleColorBar(IGC_List2$N2ENSDARG, 'lightblue'),
backgroundSize = '98% 88%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center')
tpList <- data.frame(N1N3, N1N2, N3N6, N3N4, N2ENSDARG, N2ENSAMXG, N6N7, N6ENSGACG, N4N5, N4ENSONIG, N7ENSTRUG, N7ENSTNIG, N5ENSXMAG, N5ENSORLG) %>% t()
BranchIGCmean <- data.frame(rowMeans(tpList))
datatable(BranchIGCmean, colnames = "average") %>%
formatRound( columns = 1 , 3) %>%
formatStyle(colnames(BranchIGCmean)[1:ncol(BranchIGCmean)],
background = styleColorBar(BranchIGCmean$rowMeans.tpList., 'lightblue'),
backgroundSize = '98% 88%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center')
averageTau <- rowMeans(MG[28:41,]) %>% data.frame()
datatable(averageTau, colnames = "average") %>%
formatRound( columns = 1 , 3) %>%
formatStyle(colnames(averageTau)[1:ncol(averageTau)],
background = styleColorBar(averageTau$., 'lightblue'),
backgroundSize = '98% 88%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center')
PlotBranch <- function(x){
one <- paste("(", x, ",1->2)",sep = "")
two <- paste("(", x, ",2->1)",sep = "")
mut <- paste("(", x, ",mut)",sep = "")
num <- MG[one,] + MG[two,]
den <- num + MG[mut,]
s <- lm(num~den-1)
class(s)
#print(s$coefficients[1])
qplot(den, num) +
geom_abline(slope = s$coefficients[1], intercept = 0) +
ggtitle(label = x, subtitle = paste("slope:", toString(s$coefficients[1]), sep = " "))
}
PlotBranch("N1,N3")
PlotBranch("N1,N2")
PlotBranch("N3,N6")
PlotBranch("N3,N4")
PlotBranch("N2,ENSDARG")
PlotBranch("N2,ENSAMXG")
PlotBranch("N6,N7")
PlotBranch("N6,ENSGACG")
PlotBranch("N4,N5")
PlotBranch("N4,ENSONIG")
PlotBranch("N7,ENSTRUG")
PlotBranch("N7,ENSTNIG")
PlotBranch("N5,ENSXMAG")
PlotBranch("N5,ENSORLG")
Asymmetry <- function(x){
one <- paste("(", x, ",1->2)",sep = "")
two <- paste("(", x, ",2->1)",sep = "")
qplot(MG[one,], MG[two,], main = x) + geom_abline(slope = 1, intercept = 0) +
labs(x="1->2", y="2->1")
}
Asymmetry("N1,N3")
Asymmetry("N1,N2")
Asymmetry("N3,N6")
Asymmetry("N3,N4")
Asymmetry("N2,ENSDARG")
Asymmetry("N2,ENSAMXG")
Asymmetry("N6,N7")
Asymmetry("N6,ENSGACG")
Asymmetry("N4,N5")
Asymmetry("N4,ENSONIG")
Asymmetry("N7,ENSTRUG")
Asymmetry("N7,ENSTNIG")
Asymmetry("N5,ENSXMAG")
Asymmetry("N5,ENSORLG")
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
plot(MG["omega",], MG["tau",])
abline(lm(MG["tau",]~MG["omega",]))
#labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))
summary(lm(MG["omega",]~MG["tau",]))
summary(aov(MG["omega",]~MG["tau",]))
MGstau <- MG[28:41,] %>%
#log10() %>%
data.frame() %>%
rownames_to_column(var = "branch")
MGstau
new <- melt(MGstau, id.vars = "branch", value.name = "tau")
colnames(new)[colnames(new) == "variable"] <- "gene"
new
A <- aov(data = new, formula = tau~branch+gene)    # A for ANOVA output
summary(A)
library(lme4)
library(Matrix)
data <- data.frame(MG)
scale0 <- colSums(MG[c(44:57, 60:73),]) # sum of 1 -> 2 and 2 -> 1
tau.encount <- colSums(MG[c(44:57, 60:73),]) * MG[1,]
data <- rbind(MG, scale0, tau.encount)
data <- data[c(1, 8, 28:41, 90, 91),]
taucountmatrix <- MG[44:57,]+MG[60:73,]
scale0matrix <- taucountmatrix/MG[28:41,]
omegamatrix <- rbind(MG[8,], MG[8,], MG[8,], MG[8,],MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,])
rownames(omegamatrix) <- rownames(MG[12:25,])
rownames(scale0matrix) <- rownames(MG[12:25,])
rownames(taucountmatrix) <- rownames(MG[12:25,])
newmatrix=matrix(rep(1,14*45),nrow=14)
for(i in 1:14){
newmatrix[i,]=scale0matrix[i,]/MG[1,]
}
newmatrix=newmatrix/MG[12:25,]
genenamesmatrix <- rbind(colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix) )
branchnamesmatrix <- cbind(rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix))
taucountvector <- c(taucountmatrix)
scale0vector <- c(scale0matrix)
omegavector <- c(omegamatrix)
genenamesvector <- c(genenamesmatrix)
branchnamesvector <- c(branchnamesmatrix)
data=data.frame(IGCevent=taucountvector,scale0=log(scale0vector),omega=omegavector,genename=genenamesvector,
branchname=branchnamesvector, seqdiff=c(newmatrix ))
library(lme4)
glm(round(IGCevent)~scale0+genename+seqdiff+seqdiff*genename,data=data,family = "poisson")
glm(IGCevent~scale0+branchname+genename,data=data,family = poisson)
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
load("Rdatas/IGC_data1.3.RData")
New_Swapped_Forced_Clocked_1 <- Readin4SwapFClocked(NameList4Swap, 'NSFC1', 'New_Swapped_Forced_Clocked_1')
New_Unswapped_Forced_Clocked_1 <- Readin4SwapFClocked(NameList4Swap, 'NSFC1', 'New_Unswapped_Forced_Clocked_1')
NSFC1 <- New_Swapped_Forced_Clocked_1[2,] %>% as.matrix()
NUFC1 <- New_Unswapped_Forced_Clocked_1[2,] %>% as.matrix()
NSUFC1 <- cbind(NSFC1, NUFC1, NSFC1-NUFC1)
colnames(NSUFC1) <- c('Swapped_Loglikelihood', 'Unswapped_Loglikelihood', 'difference')
datatable(cbind(NSFC1, NUFC1, NSFC1-NUFC1, (NSFC1-NUFC1)>0), colnames = c('Swapped_Loglikelihood', 'Unswapped_Loglikelihood', 'difference', 'Swap>Unswap'), options = list(pageLength=45)) %>%
formatRound( columns = 1:3 , 3) %>%
formatStyle(
'V4',
backgroundColor = styleEqual(c(TRUE, FALSE), c('red', 'yellow'))
)
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
source("ReadinUnit.R")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
sort(p)
load("~/Desktop/IGC_DATA/Rdatas/IGC_data2.0.RData")
sort(p)
source('~/Desktop/IGC_DATA/simple_analysis.R', echo=TRUE)
source('~/Desktop/IGC_DATA/simple_analysis2.R', echo=TRUE)
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
source("ReadinUnit.R")
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
source("ReadinUnit.R")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
IGC_Full_force_noclock <- ReadinF(NameList, "", "IGC_Full_force_noclock")
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5])
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
sort(IGC_Full_noforce_noclock["tau",])
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
print(proportion)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5]) %>% as.vector()
