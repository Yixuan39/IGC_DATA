}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
print(mut)
}
}
namelists(List2)
IGC2_Full_noforce_noclock[[1]]
namelists <- function(cases){
for(case in cases){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
print(IGC2_Full_noforce_noclock[[1]][mut])
}
}
namelists(List2)
namelists("228")
namelists <- function(cases){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
print(IGC2_Full_noforce_noclock[[1]][mut])
}
namelists("228")
namelists <- function(cases){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
print(IGC2_Full_noforce_noclock[[1]][mut])
}
namelists("MG228")
namelists <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
print(IGC2_Full_noforce_noclock[[1]][mut])
}
namelists("MG228")
namelists <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
print(IGC2_Full_noforce_noclock[[case]][mut])
}
namelists("MG228")
namelists <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
one2twoSum <- IGC2_Full_noforce_noclock[[case]][one2two]
two2oneSum <- IGC2_Full_noforce_noclock[[case]][two2one]
mutSum <- IGC2_Full_noforce_noclock[[case]][mut]
num <- sum(one2twoSum, two2oneSum)
den <- sum(one2twoSum, two2oneSum, mutSum)
p = num/den
return(p)
}
namelists("MG228")
IGC2_Full_noforce_noclock[[1]]
proportionSep <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
one2twoSum <- IGC2_Full_noforce_noclock[[case]][one2two]
two2oneSum <- IGC2_Full_noforce_noclock[[case]][two2one]
mutSum <- IGC2_Full_noforce_noclock[[case]][mut]
num <- sum(one2twoSum, two2oneSum)
den <- sum(one2twoSum, two2oneSum, mutSum)
p = num/den
return(p)
}
proportionSep("MG228")
proportionWhole <- function(cases){
out = c()
for(case in cases){
out = append(out, c(case, proportionSep(case)))
}
return(out)
}
proportionWhole(List2)
cases = restList(List2)
proportionWhole(cases)
matrix(proportionWhole(cases))
matrix(proportionWhole(cases), byrow = True, ncol = 2)
matrix(proportionWhole(cases), byrow = TRUE, ncol = 2)
# Calculate proportion
IGC2_Full_noforce_noclock[[1]]
proportionSep <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
one2twoSum <- IGC2_Full_noforce_noclock[[case]][one2two]
two2oneSum <- IGC2_Full_noforce_noclock[[case]][two2one]
mutSum <- IGC2_Full_noforce_noclock[[case]][mut]
num <- sum(one2twoSum, two2oneSum)
den <- sum(one2twoSum, two2oneSum, mutSum)
p = num/den
return(p)
}
proportionWhole <- function(cases){
out = c()
for(case in cases){
out = append(out, c(case, proportionSep(case)))
}
return(out)
}
cases = restList(List2)
raw <-matrix(proportionWhole(cases), byrow = TRUE, ncol = 2)
proportion_IGC2 <- raw[,2]
rownames(proportion_IGC2) <- raw[,1]
names(proportion_IGC2) <- raw[,1]
proportion_IGC2
data.frame(proportion_IGC2)
datatable(data.frame(proportion_IGC2))
proportion_IGC2 <- datatable(data.frame(proportion_IGC2))
plot(proportion_IGC2)
plot(raw)
raw
sort(raw[,2])
raw
IGC2_Full_noforce_noclock[[1]]
raw
proportion_IGC2 <- as.numeric(raw[,2])
names(proportion_IGC2) <- raw[,1]
proportion_IGC2
sort(porportion_IGC2)
sort(proportion_IGC2)
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
IGC_Full_force_noclock[c(44:57),]
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
library(rlist)
source("ReadinUnit.R")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
IGC_Full_force_noclock <- ReadinF(NameList, "", "IGC_Full_force_noclock")
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
IGC_Full_force_noclock[c(44:57),]
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5]) %>% as.vector()
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
sort(IGC_Full_noforce_noclock["tau",])
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
print(proportion)
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
library(rlist)
source("ReadinUnit.R")
# With clock
NewSwappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked1')
NewUnswappedClocked1 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked1')
NewSwappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked2')
NewUnswappedClocked2 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked2')
NewSwappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewSwappedClocked3')
NewUnswappedClocked3 <- Readin4SwapClocked(NameList4Swap, '', 'NewUnswappedClocked3')
NSC3 <- NewSwappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NUC3 <- NewUnswappedClocked3[c(2,9),] %>% as.matrix() %>% t()
NSUC3 <- data.frame(NUC3[,1],NSC3[,1], NUC3[,1]-NSC3[,1], NUC3[,2],NSC3[,2], NUC3[,2]-NSC3[,2])
colnames(NSUC3) <- c('unswap_ll', 'swap_ll', 'll_diference', 'unswap_tau', 'swap_tau', 'tau_difference')
datatable(NSUC3,
#options = list(pageLength=45), # show all 45 dataset
caption = "Clock") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,3], NSUC3[,6],
#xlim = c(-400, 400),
xlab = "loglikelihood different",
ylab = "tau different"
)
abline(h=0, col="blue")
abline(v=0, col="red")
#fit <- lm(NSUC3[,6]~NSUC3[,3])
#summary(fit)
#abline(fit)
# check loglikelihood differnet small than -25
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,3])==FALSE){
if(NSUC3[i,6] != TRUE){
if(NSUC3[i,3] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
}
datatable(total,
caption = "check loglikelihood differnet small than 0") %>%
formatRound( columns = 1:6 , 3)
plot(NSUC3[,4], NSUC3[,5],
xlab = "unswapped tau",
ylab = "swapped tau")
abline(coef = c(0,1))
total = data.frame()
for(i in 1:45){
if(is.na(NSUC3[i,6])==FALSE){
if(NSUC3[i,6] < 0){
df <- NSUC3[i,]
total <- rbind(total,df)
}
}
}
datatable(total,
caption = "swapped tau larger than unswapped tau") %>%
formatRound( columns = 1:6 , 3)
IGC_Full_noforce_noclock <- Readin(NameList, "", "IGC_Full_noforce_noclock")
IGC_Full_force_noclock <- ReadinF(NameList, "", "IGC_Full_force_noclock")
form1 <- cbind(IGC_Full_noforce_noclock[2,], IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[2,]-IGC_Full_force_noclock[2,], IGC_Full_noforce_noclock[9,]) %>% data.frame()
colnames(form1) <- c("ll","ll_tau=0", "difference", "estimated tau")
IGCchangesFull <- function(dataset){
a = dataset[c(44:57),]
b = dataset[c(60:73),]
mutation = dataset[c(76:89),]
num = colSums(a) + colSums(b)
den = num + colSums(mutation)
num/den
}
p <- IGCchangesFull(IGC_Full_noforce_noclock)
form1 <- cbind(form1,p)
form1
sort(p)
datatable(form1
#options = list(pageLength=45) # show all 45 dataset
) %>%
formatRound( columns = 1:5 , 3)
#hist(form1[,3], xlim = 5)
#sort(form1[,3])
sort(form1[,5]) %>% as.vector()
#TIGC_Full_noforce_noclock <- t(IGC_Full_noforce_noclock)
ot <- lm(IGC_Full_noforce_noclock["omega",]~IGC_Full_noforce_noclock["tau",])$coefficients
pearson <- cor(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], method = "pearson")
plot(IGC_Full_noforce_noclock["omega",], IGC_Full_noforce_noclock["tau",], xlab = "omega", ylab = "tau")
abline(lm( IGC_Full_noforce_noclock["tau",]~IGC_Full_noforce_noclock["omega",]))
sort(IGC_Full_noforce_noclock["tau",])
#print(IGC_Full_noforce_noclock)
proportion <- IGC_Full_noforce_noclock[11:25,] / colSums(IGC_Full_noforce_noclock[11:25,])
print(proportion)
save.image("~/Desktop/IGC_DATA/Rdatas/IGC_data2.0.RData")
