}
}
else{
return(FALSE)
}
}
# IGC2Read is a module of List Function. It reads one data outcome as a vector.
IGC2Read <- function(number,directory) {
cwd <- getwd()
file = summaryFile(paste("inputFiles/", directory, sep = ""),number)
path = paste(cwd, "/inputFiles/",directory,"/", number, "/save/", file, sep = "")
#file = file.exists(path)
if(file != FALSE){
v <- scan(path, what = character())
splitPoint = (length(v) - 1)/2
value <- as.numeric(v[1:splitPoint])
names <- v[(splitPoint + 2):length(v)]
names(value) <- names
return(value)
}
else{
print(paste(number, "does not exist", sep = ""))
}
}
ListFunction <- function(directory,option) {
folder = paste("inputFiles/", directory, sep = "")
cases = as.character(sort(as.numeric(list.files(folder))))
if(option == "List"){
output = list()
for(case in cases) {
#file = summaryFile(folder,case)
name = paste("MG", case, sep = "")#case
number = case#substr(case, start=3, stop = nchar(case))
data <- IGC2Read(number, directory)
output[[name]]<- data
}
return(output)
}
if(option == "Matrix"){
#output = NoMissingGeneName
for(case in cases) {
#name = case
number = substr(case, start=3, stop = nchar(case))
data <- IGC2Read(number, directory)
#lengthList=append(lengthList,data)
output = merge(output,data,all=TRUE,sort=FALSE)
}
#output = matrix( nrow = max(lengthList), ncol = )
return(output)
}
}
IGC2_Full_noforce_noclock <- ListFunction("IGC2_Full_noforce_noclock","List")
restList <- function(List) {
restList = c()
for(case in List){
number = substr(case, start=3, stop = nchar(case))
path = paste("/Users/yixuanyang/Desktop/IGC_DATA/inputFiles/IGC2_Full_noforce_noclock/", number, "/save/MG94_01_02_nonclockqq_summary.txt", sep = "")
file = file.exists(path)
if(file == TRUE){
restList <- append(restList,case)
}
}
return(restList)
}
# matrix of general parameters
gp = c()
for(i in List2){
vector = IGC2_Full_noforce_noclock[[i]][1:9]
gp = rbind(gp,IGC2_Full_noforce_noclock[[i]][c(1,2,9)])
}
rownames(gp) <- restList(List2)
gp <- data.frame(gp)
datatable(gp)
# Calculate proportion
#IGC2_Full_noforce_noclock[[1]]
proportionSep <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
one2twoSum <- IGC2_Full_noforce_noclock[[case]][one2two]
two2oneSum <- IGC2_Full_noforce_noclock[[case]][two2one]
mutSum <- IGC2_Full_noforce_noclock[[case]][mut]
num <- sum(one2twoSum, two2oneSum)
den <- sum(one2twoSum, two2oneSum, mutSum)
p = num/den
return(p)
}
proportionWhole <- function(cases){
out = c()
for(case in cases){
out = append(out, c(case, proportionSep(case)))
}
return(out)
}
#cases = restList(List2)
raw <-matrix(proportionWhole(List2), byrow = TRUE, ncol = 2)
proportion_IGC2 <- as.numeric(raw[,2])
names(proportion_IGC2) <- raw[,1]
sort(proportion_IGC2)
datatable(data.frame(proportion_IGC2))
omega = c()
for(i in List2){
value <- IGC2_Full_noforce_noclock[[i]][8]
names(value) <- i
omega = append(omega,value)
}
plot(omega,proportion_IGC2)
cor(omega,proportion_IGC2)
s = lm(proportion_IGC2~omega)
abline(s)
IGC1_Swap_noforce_clock <- ListFunction("IGC1_Swap_noforce_clock","List")
IGC1_Unswap_noforce_clock <- ListFunction("IGC1_Unswap_noforce_clock","List")
IGC2_Swap_noforce_clock <- ListFunction("IGC2_Swap_noforce_clock","List")
IGC2_Unswap_noforce_clock <- ListFunction("IGC2_Unswap_noforce_clock","List")
# M stand for missing paralog gene dataset
swapTau_M <- c()
swapLL_M  <- c()
for(i in IGC2_Swap_noforce_clock){
swapTau_M <- append(swapTau_M,i[9])
swapLL_M  <- append(swapLL_M,i[2])
}
names(swapTau_M) <- names(IGC2_Unswap_noforce_clock)
names(swapLL_M)  <- names(IGC2_Unswap_noforce_clock)
unswapTau_M <- c()
unswapLL_M  <- c()
for(i in IGC2_Unswap_noforce_clock){
unswapTau_M <- append(unswapTau_M,i[9])
unswapLL_M  <- append(unswapLL_M,i[2])
}
names(unswapTau_M) <- names(IGC2_Unswap_noforce_clock)
names(unswapLL_M)  <- names(IGC2_Unswap_noforce_clock)
# F stand for full gene dataset
swapTau_F <- c()
swapLL_F  <- c()
for(i in IGC1_Swap_noforce_clock){
swapTau_F <- append(swapTau_F,i[9])
swapLL_F  <- append(swapLL_F,i[2])
}
names(swapTau_F) <- names(IGC1_Unswap_noforce_clock)
names(swapLL_F)  <- names(IGC1_Unswap_noforce_clock)
unswapTau_F <- c()
unswapLL_F  <- c()
for(i in IGC1_Unswap_noforce_clock){
unswapTau_F <- append(unswapTau_F,i[9])
unswapLL_F  <- append(unswapLL_F,i[2])
}
names(unswapTau_F) <- names(IGC1_Unswap_noforce_clock)
names(unswapLL_F)  <- names(IGC1_Unswap_noforce_clock)
tau.dif.M <- unswapTau_M - swapTau_M
ll.dif.M  <- unswapLL_M - swapLL_M
plot(ll.dif.M,tau.dif.M)
abline(h=0, col="blue")
abline(v=0, col="red")
tau.dif.F <- unswapTau_F - swapTau_F
ll.dif.F  <- unswapLL_F - swapLL_F
plot(ll.dif.F,tau.dif.F)
abline(h=0, col="blue")
abline(v=0, col="red")
plot(swapTau_M,unswapTau_M)
abline(coef = c(0,1))
plot(swapTau_F,unswapTau_F)
abline(coef = c(0,1))
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
library(ggplot2)
length_M <- c()
for(i in IGC2_Unswap_noforce_clock){
length_M <- append(length_M,i[1])
}
names(length_M) <- names(IGC2_Unswap_noforce_clock)
length_M
length_F <- c()
for(i in IGC1_Unswap_noforce_clock){
length_F <- append(length_F,i[1])
}
names(length_F) <- names(IGC1_Unswap_noforce_clock)
length_F
SwapTestM <- matrix(c(length_M,ll.dif.M,tau.dif.M), byrow = FALSE)
SwapTestM
SwapTestM <- matrix(c(length_M,ll.dif.M,tau.dif.M), ncol = 3)
SwapTestM
SwapTestM <- matrix(c(length_M,ll.dif.M,tau.dif.M), ncol = 3,colnames(SwapTestM)=c("length","ll.dif","tau.dif"))
tau.dif.M <- unswapTau_M - swapTau_M
ll.dif.M  <- unswapLL_M - swapLL_M
SwapTestM <- matrix(c(length_M,ll.dif.M,tau.dif.M), ncol = 3)
colnames(SwapTestM)=c("length","ll.dif","tau.dif")
SwapTestM
plot(swapTau_M,unswapTau_M)
abline(coef = c(0,1))
plot(ll.dif.M,tau.dif.M)
abline(h=0, col="blue")
abline(v=0, col="red")
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif))
SwapTestM <- matrix(c(length_M,ll.dif.M,tau.dif.M), ncol = 3) %>% as.data.frame()
colnames(SwapTestM)=c("length","ll.dif","tau.dif")
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif))
M.ll.tau <- ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif))
M.ll.tau
M.ll.tau <- ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif)) + geom_point()
M.ll.tau
M.ll.tau <- ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point()
M.ll.tau <- ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point()
M.ll.tau
SwapTestF <- matrix(c(length_F,ll.dif.F,tau.dif.F), ncol = 3) %>% as.data.frame()
colnames(SwapTestF)=c("length","ll.dif","tau.dif")
F.ll.tau <- ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point()
F.ll.tau
M.ll.tau <- ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
M.ll.tau
F.ll.tau <- ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
F.ll.tau
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(10))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(100))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(2))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(7))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(4))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(7))
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
tau.dif.M <- unswapTau_M - swapTau_M
ll.dif.M  <- unswapLL_M - swapLL_M
SwapTestM <- matrix(c(length_M,ll.dif.M,tau.dif.M), ncol = 3) %>% as.data.frame()
colnames(SwapTestM)=c("length","ll.dif","tau.dif")
plot(ll.dif.M,tau.dif.M)
abline(h=0, col="blue")
abline(v=0, col="red")
tau.dif.F <- unswapTau_F - swapTau_F
ll.dif.F  <- unswapLL_F - swapLL_F
SwapTestF <- matrix(c(length_F,ll.dif.F,tau.dif.F), ncol = 3) %>% as.data.frame()
colnames(SwapTestF)=c("length","ll.dif","tau.dif")
plot(ll.dif.F,tau.dif.F)
abline(h=0, col="blue")
abline(v=0, col="red")
plot(swapTau_M,unswapTau_M)
abline(coef = c(0,1))
plot(swapTau_F,unswapTau_F)
abline(coef = c(0,1))
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(7))
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(3))
ggplot(SwapTestF, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
ggplot(SwapTestM, aes(x=ll.dif, y=tau.dif, color=length)) + geom_point() + scale_color_gradientn(colours = rainbow(5))
knitr::opts_chunk$set(echo = TRUE)
library(DT)
library(dplyr)
library(ggplot2)
# getList function will return a list of folder names in a data folder.
getList <- function(directory){
cwd <- getwd()
ListOutput = c()
for(i in c(1:5588)){
path = paste(cwd,"/inputfiles/",directory,"/",i,"/save/MG94_01_02_nonclockqq_summary.txt", sep = "")
file = file.exists(path)
if(file == TRUE){
ListOutput = append(ListOutput,paste("MG",as.character(i),sep=""))
}
}
return(ListOutput)
}
summaryFile <- function(folder, subfolder){
savePath <- paste(folder, "/", subfolder, "/save/", sep = "")
files <- list.files(savePath)
if(length(files) == 2){
for(i in files){
if(grep("summary",i)){
return(i)
}
}
}
else{
return(FALSE)
}
}
# IGC2Read is a module of List Function. It reads one data outcome as a vector.
IGC2Read <- function(number,directory) {
cwd <- getwd()
file = summaryFile(paste("inputFiles/", directory, sep = ""),number)
path = paste(cwd, "/inputFiles/",directory,"/", number, "/save/", file, sep = "")
#file = file.exists(path)
if(file != FALSE){
v <- scan(path, what = character())
splitPoint = (length(v) - 1)/2
value <- as.numeric(v[1:splitPoint])
names <- v[(splitPoint + 2):length(v)]
names(value) <- names
return(value)
}
else{
print(paste(number, "does not exist", sep = ""))
}
}
ListFunction <- function(directory,option) {
folder = paste("inputFiles/", directory, sep = "")
cases = as.character(sort(as.numeric(list.files(folder))))
if(option == "List"){
output = list()
for(case in cases) {
#file = summaryFile(folder,case)
name = paste("MG", case, sep = "")#case
number = case#substr(case, start=3, stop = nchar(case))
data <- IGC2Read(number, directory)
output[[name]]<- data
}
return(output)
}
if(option == "Matrix"){
#output = NoMissingGeneName
for(case in cases) {
#name = case
number = substr(case, start=3, stop = nchar(case))
data <- IGC2Read(number, directory)
#lengthList=append(lengthList,data)
output = merge(output,data,all=TRUE,sort=FALSE)
}
#output = matrix( nrow = max(lengthList), ncol = )
return(output)
}
}
IGC2_Full_noforce_noclock <- ListFunction("IGC2_Full_noforce_noclock","List")
restList <- function(List) {
restList = c()
for(case in List){
number = substr(case, start=3, stop = nchar(case))
path = paste("/Users/yixuanyang/Desktop/IGC_DATA/inputFiles/IGC2_Full_noforce_noclock/", number, "/save/MG94_01_02_nonclockqq_summary.txt", sep = "")
file = file.exists(path)
if(file == TRUE){
restList <- append(restList,case)
}
}
return(restList)
}
# matrix of general parameters
gp = c()
for(i in List2){
vector = IGC2_Full_noforce_noclock[[i]][1:9]
gp = rbind(gp,IGC2_Full_noforce_noclock[[i]][c(1,2,9)])
}
rownames(gp) <- restList(List2)
gp <- data.frame(gp)
datatable(gp)
# Calculate proportion
#IGC2_Full_noforce_noclock[[1]]
proportionSep <- function(case){
namelist <- names(IGC2_Full_noforce_noclock[[case]])
one2two <- c()
two2one <- c()
mut <- c()
for(i in namelist){
if(str_detect(i,"1->2")){
if (str_detect(i,"N0")==FALSE){
one2two <- append(one2two,i)
}
}
}
for(i in namelist){
if(str_detect(i,"2->1")){
if (str_detect(i,"N0")==FALSE){
two2one <- append(two2one,i)
}
}
}
for(i in namelist){
if(str_detect(i,"mut")){
if (str_detect(i,"N0")==FALSE){
mut <- append(mut,i)
}
}
}
one2twoSum <- IGC2_Full_noforce_noclock[[case]][one2two]
two2oneSum <- IGC2_Full_noforce_noclock[[case]][two2one]
mutSum <- IGC2_Full_noforce_noclock[[case]][mut]
num <- sum(one2twoSum, two2oneSum)
den <- sum(one2twoSum, two2oneSum, mutSum)
p = num/den
return(p)
}
proportionWhole <- function(cases){
out = c()
for(case in cases){
out = append(out, c(case, proportionSep(case)))
}
return(out)
}
#cases = restList(List2)
raw <-matrix(proportionWhole(List2), byrow = TRUE, ncol = 2)
proportion_IGC2 <- as.numeric(raw[,2])
names(proportion_IGC2) <- raw[,1]
sort(proportion_IGC2)
datatable(data.frame(proportion_IGC2))
omega = c()
for(i in List2){
value <- IGC2_Full_noforce_noclock[[i]][8]
names(value) <- i
omega = append(omega,value)
}
plot(omega,proportion_IGC2)
cor(omega,proportion_IGC2)
s = lm(proportion_IGC2~omega)
abline(s)
IGC1_Swap_noforce_clock <- ListFunction("IGC1_Swap_noforce_clock","List")
IGC1_Unswap_noforce_clock <- ListFunction("IGC1_Unswap_noforce_clock","List")
IGC2_Swap_noforce_clock <- ListFunction("IGC2_Swap_noforce_clock","List")
IGC2_Unswap_noforce_clock <- ListFunction("IGC2_Unswap_noforce_clock","List")
# M stand for missing paralog gene dataset
swapTau_M <- c()
swapLL_M  <- c()
for(i in IGC2_Swap_noforce_clock){
swapTau_M <- append(swapTau_M,i[9])
swapLL_M  <- append(swapLL_M,i[2])
}
names(swapTau_M) <- names(IGC2_Unswap_noforce_clock)
names(swapLL_M)  <- names(IGC2_Unswap_noforce_clock)
unswapTau_M <- c()
unswapLL_M  <- c()
for(i in IGC2_Unswap_noforce_clock){
unswapTau_M <- append(unswapTau_M,i[9])
unswapLL_M  <- append(unswapLL_M,i[2])
}
names(unswapTau_M) <- names(IGC2_Unswap_noforce_clock)
names(unswapLL_M)  <- names(IGC2_Unswap_noforce_clock)
# F stand for full gene dataset
swapTau_F <- c()
swapLL_F  <- c()
for(i in IGC1_Swap_noforce_clock){
swapTau_F <- append(swapTau_F,i[9])
swapLL_F  <- append(swapLL_F,i[2])
}
names(swapTau_F) <- names(IGC1_Unswap_noforce_clock)
names(swapLL_F)  <- names(IGC1_Unswap_noforce_clock)
unswapTau_F <- c()
unswapLL_F  <- c()
for(i in IGC1_Unswap_noforce_clock){
unswapTau_F <- append(unswapTau_F,i[9])
unswapLL_F  <- append(unswapLL_F,i[2])
}
names(unswapTau_F) <- names(IGC1_Unswap_noforce_clock)
names(unswapLL_F)  <- names(IGC1_Unswap_noforce_clock)
# length
length_M <- c()
for(i in IGC2_Unswap_noforce_clock){
length_M <- append(length_M,i[1])
}
names(length_M) <- names(IGC2_Unswap_noforce_clock)
length_F <- c()
for(i in IGC1_Unswap_noforce_clock){
length_F <- append(length_F,i[1])
}
names(length_F) <- names(IGC1_Unswap_noforce_clock)
IGC1_Swap_noforce_clock <- ListFunction("IGC1_Swap_noforce_clock","List")
IGC1_Unswap_noforce_clock <- ListFunction("IGC1_Unswap_noforce_clock","List")
IGC2_Swap_noforce_clock <- ListFunction("IGC2_Swap_noforce_clock","List")
IGC2_Unswap_noforce_clock <- ListFunction("IGC2_Unswap_noforce_clock","List")
IGC1_Swap_noforce_clock <- ListFunction("IGC1_Swap_noforce_clock","List")
IGC1_Unswap_noforce_clock <- ListFunction("IGC1_Unswap_noforce_clock","List")
IGC2_Swap_noforce_clock <- ListFunction("IGC2_Swap_noforce_clock","List")
IGC2_Unswap_noforce_clock <- ListFunction("IGC2_Unswap_noforce_clock","List")
IGC1_Swap_noforce_clock <- ListFunction("IGC1_Swap_noforce_clock","List")
IGC1_Unswap_noforce_clock <- ListFunction("IGC1_Unswap_noforce_clock","List")
IGC2_Swap_noforce_clock <- ListFunction("IGC2_Swap_noforce_clock","List")
IGC2_Unswap_noforce_clock <- ListFunction("IGC2_Unswap_noforce_clock","List")
IGC1_Swap_noforce_clock <- ListFunction("IGC1_Swap_noforce_clock","List")
IGC1_Unswap_noforce_clock <- ListFunction("IGC1_Unswap_noforce_clock","List")
IGC2_Swap_noforce_clock <- ListFunction("IGC2_Swap_noforce_clock","List")
IGC2_Unswap_noforce_clock <- ListFunction("IGC2_Unswap_noforce_clock","List")
restList <- function(List) {
restList = c()
for(case in List){
number = substr(case, start=3, stop = nchar(case))
path = paste("/Users/yixuanyang/Desktop/IGC_DATA/inputFiles/IGC2_Full_noforce_noclock/", number, "/save/MG94_01_02_nonclockqq_summary.txt", sep = "")
file = file.exists(path)
if(file == TRUE){
restList <- append(restList,case)
}
}
return(restList)
}
# matrix of general parameters
gp = c()
for(i in List2){
vector = IGC2_Full_noforce_noclock[[i]][1:9]
gp = rbind(gp,IGC2_Full_noforce_noclock[[i]][c(1,2,9)])
}
rownames(gp) <- restList(List2)
gp <- data.frame(gp)
datatable(gp)
List2
