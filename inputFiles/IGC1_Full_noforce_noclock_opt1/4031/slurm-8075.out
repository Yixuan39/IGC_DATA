/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconv.py:292: RuntimeWarning: overflow encountered in exp
  x_process = np.exp(self.x_process)
/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconFunc.py:66: RuntimeWarning: invalid value encountered in double_scalars
  QbasicRate *= kappa
/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconFunc.py:69: RuntimeWarning: invalid value encountered in double_scalars
  QbasicRate *= omega
/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconv.py:506: RuntimeWarning: overflow encountered in exp
  x_rates = np.exp(self.x_rates)
number of sites to be analyzed:  174
log likelihood =  -14260.561193152509
Edge derivatives =  [113.68187577587302, 81.3129031052327, 141.88658122747765, 90.34673104950382, 40.28281176643632, 38.080319418284866, 163.93682618674467, 117.73915363335028, 71.29321193415258, 93.13318731161095, 45.20994067670479, 83.56518609560786, 73.04477786366394, 83.9309240778977, 142.63885596168828, 133.20256967692836]
other derivatives: [ 165.45782273  167.65006876 -144.66641005   45.1294909   427.29006964
   44.01226761]
Current x array =  [-0.62498103 -0.85257492 -0.5658183   0.40546511 -2.30258509 -2.30258509
 -6.90775528 -6.90775528 -6.90775528 -6.90775528 -6.90775528 -6.90775528
 -6.90775528 -6.90775528 -6.90775528 -6.90775528 -6.90775528 -6.90775528
 -6.90775528 -6.90775528 -6.90775528 -6.90775528]
log likelihood =  -13728.803646614295
Edge derivatives =  [113.55221717989812, 81.37618200430992, 144.12476139961686, 88.17938808943975, 38.43565510048074, 36.49254465775446, 164.1399313913225, 117.24062654685738, 70.52523020902605, 94.519224752226, 42.25141947038555, 88.04939755224783, 73.36792327905493, 83.26112696728586, 142.10325522664363, 133.62914474784253]
other derivatives: [119.63184079 122.70538718 -69.09176591  31.72099241 222.8325684
  48.57211025]
Current x array =  [-0.62403644 -0.85125642 -0.80348084  0.47960526 -1.6006195  -2.28730251
 -6.72099511 -6.77417188 -6.67465953 -6.75933082 -6.84157741 -6.84519573
 -6.63843469 -6.71432969 -6.79063254 -6.75475314 -6.83348296 -6.77047176
 -6.78775502 -6.76987091 -6.67342367 -6.6889259 ]
log likelihood =  -12701.196029044237
Edge derivatives =  [107.77150909622384, 81.63236348669781, 141.8052121698167, 81.02867378250339, 28.710802751083758, 33.44630594771177, 165.12210668902796, 108.43658527026916, 68.78896381074283, 93.2471828483878, 33.7417925137461, 96.68810834471337, 79.12225181299159, 72.0745289011348, 132.97611591514965, 134.05368495207995]
other derivatives: [-10753.79950635   9384.82080528    253.05562303   -234.67400752
   -329.02462408     97.34558262]
Current x array =  [-0.05       -0.05       -1.30479408  0.75555772  0.1006991  -2.03581352
 -5.63019638 -5.99212473 -5.28500826 -5.91671249 -6.47623789 -6.49796885
 -5.06084316 -5.58888395 -6.11463588 -5.84357451 -6.43386986 -5.91479489
 -6.08209703 -5.97128894 -5.30916267 -5.40401957]
log likelihood =  -12685.594738292046
Edge derivatives =  [107.88841754150124, 81.54696750407537, 141.92620302748128, 80.98847320386542, 28.731220473272376, 33.388629761047916, 165.1396506536413, 108.37902776162757, 68.78200030285115, 93.26722851059516, 33.71444045853693, 96.73398175278122, 79.14751915503422, 72.07409718958934, 133.00684276447927, 134.05534068040944]
other derivatives: [-10197.56964524   9183.43466765    253.85197659   -223.80700102
   -336.21618059     97.58987289]
Current x array =  [-0.05171155 -0.05       -1.31260263  0.75786312  0.12360065 -2.03550584
 -5.62468524 -5.98818402 -5.27815569 -5.91231016 -6.47426606 -6.49610589
 -5.05289899 -5.58317243 -6.11117191 -5.83907559 -6.43164682 -5.91079277
 -6.07855934 -5.96721454 -5.30224384 -5.39756767]
log likelihood =  -12633.147509867576
Edge derivatives =  [108.40481051499117, 81.18567917843085, 142.39439706197913, 80.8304956880165, 28.815042551632857, 33.16518099114862, 165.17871608340363, 108.17501984857216, 68.75946606533428, 93.34174087225091, 33.609466587570125, 96.91454925477382, 79.23972824195071, 72.07013503948167, 133.1373230796675, 134.0408423171645]
other derivatives: [-8324.44384287  8409.26768433   257.10760383  -182.40862119
  -362.65482777    98.80204743]
Current x array =  [-0.05855774 -0.05       -1.34383681  0.76708472  0.21520683 -2.0342751
 -5.6026407  -5.97242119 -5.25074538 -5.89470083 -6.46637873 -6.48865403
 -5.02112231 -5.56032633 -6.09731604 -5.82107992 -6.42275468 -5.89478426
 -6.06440858 -5.95091693 -5.27456853 -5.37176005]
log likelihood =  -12539.817672803609
Edge derivatives =  [110.22490611734057, 80.01313122691623, 143.63762946666563, 80.39983283650872, 29.05766984117789, 32.553769466498714, 165.10591188802707, 107.68492674539576, 68.73804468614574, 93.46084067036777, 33.31764409398102, 97.43717891047939, 79.4283934236199, 72.05197067717941, 133.53018233402787, 133.85006267690022]
other derivatives: [-4897.56621391  6423.23429929   266.26657927   -78.73095456
  -420.5339792    103.6820322 ]
Current x array =  [-0.07872788 -0.05       -1.4316636   0.79355496  0.47442816 -2.0297748
 -5.53759561 -5.92590215 -5.16974887 -5.84285043 -6.44321021 -6.46674458
 -4.9273274  -5.49295133 -6.05646302 -5.7679098  -6.39666982 -5.84731013
 -6.02261325 -5.9028799  -5.19293871 -5.29557399]
log likelihood =  -12503.89109904807
Edge derivatives =  [111.6649603299693, 79.14436571227937, 144.40883295311727, 80.13402547257166, 29.19971950633115, 32.14313767920632, 164.94301069042882, 107.31855674152311, 68.77222472567416, 93.40633481738423, 33.09678299532244, 97.83533042473822, 79.49590132193951, 72.03263352250889, 133.76506412106718, 133.60095491034127]
other derivatives: [-3528.05254806  5272.12705492   271.91308618   -20.39178071
  -446.9680789    107.70127119]
Current x array =  [-0.09286375 -0.05       -1.48810758  0.81170638  0.64360071 -2.02519391
 -5.49086887 -5.89248116 -5.11138699 -5.80577562 -6.42672715 -6.45112982
 -4.85990958 -5.44461329 -6.02716708 -5.72961045 -6.3781686  -5.81284428
 -5.99253089 -5.86845429 -5.13435133 -5.240798  ]
log likelihood =  -12472.386238135166
Edge derivatives =  [113.29272768248318, 78.17333757175746, 145.21894506106852, 79.84885604961117, 29.31494559732307, 31.6834184499578, 164.68604612639274, 106.84708984197484, 68.85375517485552, 93.20970927091497, 32.82489218357025, 98.3072964523523, 79.51629927976762, 72.0041284906477, 133.9368775538759, 133.24907630894805]
other derivatives: [-2527.78791037  4188.70422436   277.11412258    33.08286978
  -466.50548029   112.32023098]
Current x array =  [-0.10861979 -0.05       -1.54426035  0.8319675   0.81629545 -2.01773378
 -5.43597607 -5.85322874 -5.04256639 -5.76249529 -6.40761087 -6.43298195
 -4.7806699  -5.38793566 -5.99283659 -5.6844705  -6.35680168 -5.77180912
 -5.9571113  -5.82814598 -5.06561829 -5.17639483]
log likelihood =  -12431.17443583373
Edge derivatives =  [115.25426990755022, 76.93011683897522, 146.24555515556014, 79.46631952920853, 29.425196822924327, 31.07999852774633, 164.23751830147572, 106.23920482566174, 68.99580954550547, 92.83002954426199, 32.47840497414303, 98.86664832788506, 79.47342229898561, 71.95403202582946, 133.95517632490038, 132.78122596576037]
other derivatives: [-1710.71860677  3043.6727684    282.25240385    87.59270713
  -481.41682782   118.18428902]
Current x array =  [-0.12893996 -0.05       -1.60648504  0.85858596  1.01557154 -2.00424146
 -5.36008113 -5.79898709 -4.94703129 -5.70308131 -6.38155897 -6.4081942
 -4.67107195 -5.30975219 -5.94550647 -5.62184892 -6.32782324 -5.71425158
 -5.90802719 -5.7726262  -4.97074296 -5.08728516]
log likelihood =  -12349.599412480613
Edge derivatives =  [118.50588086058666, 74.6097711924011, 147.9831221064187, 78.70600010714865, 29.603998674327286, 29.978065051209906, 163.05730848272952, 105.23363682794503, 69.26100107201293, 92.02973380695711, 31.923871767121422, 99.6025652140553, 79.26264521082288, 71.80439438318815, 133.45342563385913, 131.97465128308386]
other derivatives: [-909.58455985 1468.18747453  288.90899557  157.32111933 -492.6296242
  128.43265722]
Current x array =  [-0.16613871 -0.05       -1.70271301  0.90867132  1.3401661  -1.97252992
 -5.21156781 -5.69291829 -4.75946323 -5.58754023 -6.3312113  -6.36020303
 -4.45657197 -5.15708125 -5.85312243 -5.49898077 -6.27205986 -5.60026966
 -5.81180442 -5.66434552 -4.78537008 -4.91283008]
log likelihood =  -12157.954529841922
Edge derivatives =  [126.01491672277517, 69.2494210560824, 149.565259275844, 75.89838218857254, 29.68868685664293, 27.76796809984193, 158.45878845000396, 102.27430195363725, 68.71361657897044, 91.3865924878368, 30.56022778473755, 99.98780946455126, 78.3383914099653, 71.10415965496075, 131.3097076992463, 129.22823499224745]
other derivatives: [-275.27876227 -756.93842518  296.19714041  234.7273039  -490.37498684
  145.10842448]
Current x array =  [-0.25100486 -0.05       -1.89327337  1.02594959  2.01542483 -1.88832437
 -4.85634521 -5.43939959 -4.30989746 -5.31234802 -6.21177711 -6.24624268
 -3.94355416 -4.79247193 -5.63253744 -5.20464202 -6.14016477 -5.32557798
 -5.5814197  -5.4059507  -4.34249477 -4.49549624]
Traceback (most recent call last):
  File "/var/spool/slurmd/job08075/slurm_script", line 29, in <module>
    test.get_mle()
  File "/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconv.py", line 900, in get_mle
    result = scipy.optimize.minimize(f, guess_x, jac = True, method = 'L-BFGS-B', bounds = bnds)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/_minimize.py", line 623, in minimize
    return _minimize_lbfgsb(fun, x0, args, jac, bounds,
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/lbfgsb.py", line 360, in _minimize_lbfgsb
    f, g = func_and_grad(x)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/_differentiable_functions.py", line 267, in fun_and_grad
    self._update_fun()
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/_differentiable_functions.py", line 233, in _update_fun
    self._update_fun_impl()
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/_differentiable_functions.py", line 137, in update_fun
    self.f = fun_wrapped(self.x)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/_differentiable_functions.py", line 134, in fun_wrapped
    return fun(np.copy(x), *args)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/optimize.py", line 74, in __call__
    self._compute_if_needed(x, *args)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/scipy/optimize/optimize.py", line 68, in _compute_if_needed
    fg = self.fun(x, *args)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconv.py", line 758, in objective_and_gradient
    f, g = self.loglikelihood_and_gradient(display = display)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconv.py", line 676, in loglikelihood_and_gradient
    ll, edge_derivs = fn(edge_derivative = True)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/IGCexpansion/CodonGeneconv.py", line 598, in _loglikelihood2
    j_out = jsonctmctree.interface.process_json_in(j_in)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/interface.py", line 130, in process_json_in
    return impl_v2.process_json_in(j_in, debug=debug, seed = seed)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/impl_v2.py", line 851, in process_json_in
    return Reactor(toplevel.scene, debug=debug).main(toplevel.requests)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/impl_v2.py", line 834, in main
    self.react(requests, responses)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/impl_v2.py", line 809, in react
    if self._create_node_to_conditional_likelihoods(unmet_core_requests):
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/impl_v2.py", line 382, in _create_node_to_conditional_likelihoods
    self.node_to_conditional_likelihoods = get_conditional_likelihoods(
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/common_likelihood.py", line 252, in get_conditional_likelihoods
    arr = expm_objects[edge_process].expm_mul(edge_rate, arr)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/expm_helpers.py", line 177, in expm_mul
    return P.dot(A)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/pyexp/basic_ops.py", line 25, in dot
    return self._matmat(other)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/pyexp/ctmc_ops.py", line 311, in _matmat
    return self._P._parameterized_matmat(self._t, B)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/pyexp/ctmc_ops.py", line 263, in _parameterized_matmat
    return _expm_product_helper(
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/pyexp/ctmc_ops.py", line 171, in _expm_product_helper
    m, s = iteration_stash.fragment_3_1(n0, t)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/pyexp/experimental.py", line 115, in fragment_3_1
    m, value = self.cmstar(t)
  File "/home5/yyang55/.local/lib/python3.8/site-packages/jsonctmctree/pyexp/experimental.py", line 160, in cmstar
    value = int(M[r, c])
ValueError: cannot convert float NaN to integer
