---
title: "IGC data"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(DT)
library(tibble)
library(reshape2)
```

```{r nameList, echo=FALSE}
NameList <- readLines(paste( "./data/211MG/save/MG94_01_02_nonclockqq_summary.txt", sep = ""))
NameList <- unlist(strsplit(NameList[90], split=" "))
NameList <- NameList[!(NameList %in% NameList[1])]
```

```{r Read_MG, echo=FALSE}
MG211  <- readLines("./data/211MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG214  <- readLines("./data/214MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG222  <- readLines("./data/222MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG223  <- readLines("./data/223MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG337  <- readLines("./data/337MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG479  <- readLines("./data/479MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG521  <- readLines("./data/521MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG526  <- readLines("./data/526MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG561  <- readLines("./data/561MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG735  <- readLines("./data/735MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG755  <- readLines("./data/755MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG852  <- readLines("./data/852MG/save/MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MG1050 <- readLines("./data/1050MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG1053 <- readLines("./data/1053MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG1215 <- readLines("./data/1215MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2129 <- readLines("./data/2129MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2158 <- readLines("./data/2158MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2210 <- readLines("./data/2210MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2214 <- readLines("./data/2214MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2321 <- readLines("./data/2321MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2358 <- readLines("./data/2358MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2371 <- readLines("./data/2371MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2382 <- readLines("./data/2382MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG2861 <- readLines("./data/2861MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3278 <- readLines("./data/3278MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3295 <- readLines("./data/3295MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3309 <- readLines("./data/3309MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3337 <- readLines("./data/3337MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3346 <- readLines("./data/3346MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3347 <- readLines("./data/3347MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3390 <- readLines("./data/3390MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG3994 <- readLines("./data/3994MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4025 <- readLines("./data/4025MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4031 <- readLines("./data/4031MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4063 <- readLines("./data/4063MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4268 <- readLines("./data/4268MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4287 <- readLines("./data/4287MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4494 <- readLines("./data/4494MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4553 <- readLines("./data/4553MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4570 <- readLines("./data/4570MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG4932 <- readLines("./data/4932MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG5153 <- readLines("./data/5153MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG5233 <- readLines("./data/5233MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG5316 <- readLines("./data/5316MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG5550 <- readLines("./data/5550MG/save/MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG <- cbind(MG211, MG214, MG222, MG223, MG337, MG479, MG521, MG526, MG561, MG735, MG755, MG852, MG1050,
            MG1053, MG1215, MG2129, MG2158, MG2210, MG2214, MG2321, MG2358, MG2371, MG2382, MG2861,
            MG3278, MG3295, MG3309, MG3337, MG3346, MG3347, MG3390, MG3994, MG4025, MG4031,MG4063,
            MG4268, MG4287, MG4494, MG4553, MG4570, MG4932, MG5153, MG5233, MG5316, MG5550) 
rownames(MG) <- NameList
```

```{r Read_MG_Forced, echo=FALSE}
MF211 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_MG94_pillar211.txt", n = 89) %>% as.numeric()
MF214 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_MG94_pillar214.txt", n = 89) %>% as.numeric()
MF222 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_MG94_pillar222.txt", n = 89) %>% as.numeric()
MF223 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_MG94_pillar223.txt", n = 89) %>% as.numeric()
MF337 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_MG94_pillar337.txt", n = 89) %>% as.numeric()
MF211  <- readLines("./data/211MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF214  <- readLines("./data/214MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF222  <- readLines("./data/222MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF223  <- readLines("./data/223MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF337  <- readLines("./data/337MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF479  <- readLines("./data/479MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF521  <- readLines("./data/521MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF526  <- readLines("./data/526MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF561  <- readLines("./data/561MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF735  <- readLines("./data/735MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF755  <- readLines("./data/755MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF852  <- readLines("./data/852MF/save/Force_MG94_01_02_nonclockqq_summary.txt",  n = 89) %>% as.numeric()
MF1050 <- readLines("./data/1050MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF1053 <- readLines("./data/1053MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF1215 <- readLines("./data/1215MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2129 <- readLines("./data/2129MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2158 <- readLines("./data/2158MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2210 <- readLines("./data/2210MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2214 <- readLines("./data/2214MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2321 <- readLines("./data/2321MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2358 <- readLines("./data/2358MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2371 <- readLines("./data/2371MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2382 <- readLines("./data/2382MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF2861 <- readLines("./data/2861MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3278 <- readLines("./data/3278MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3295 <- readLines("./data/3295MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3309 <- readLines("./data/3309MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3337 <- readLines("./data/3337MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3346 <- readLines("./data/3346MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3347 <- readLines("./data/3347MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3390 <- readLines("./data/3390MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF3994 <- readLines("./data/3994MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4025 <- readLines("./data/4025MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4031 <- readLines("./data/4031MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4063 <- readLines("./data/4063MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4268 <- readLines("./data/4268MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4287 <- readLines("./data/4287MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4494 <- readLines("./data/4494MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4553 <- readLines("./data/4553MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4570 <- readLines("./data/4570MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF4932 <- readLines("./data/4932MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF5153 <- readLines("./data/5153MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF5233 <- readLines("./data/5233MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF5316 <- readLines("./data/5316MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MF5550 <- readLines("./data/5550MF/save/Force_MG94_01_02_nonclockqq_summary.txt", n = 89) %>% as.numeric()
MG_Forced <- cbind(MF211, MF214, MF222, MF223, MF337, MF479, MF521, MF526, MF561, MF735, MF755, MF852, 
                   MF1050, MF1053, MF1215, MF2129, MF2158, MF2210, MF2214, MF2321, MF2358, MF2371, MF2382, 
                   MF2861, MF3278, MF3295, MF3309, MF3337, MF3346, MF3347, MF3390, MF3994, MF4025, MF4031, 
                   MF4063, MF4268, MF4287, MF4494, MF4553, MF4570, MF4932, MF5153, MF5233, MF5316, MF5550)
rownames(MG_Forced) <- NameList
```

```{r Read_HKY_Forced, echo=FALSE}
HF211 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_HKY_pillar211.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF214 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_HKY_pillar214.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF222 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_HKY_pillar222.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF223 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_HKY_pillar223.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF337 <- readLines("/Users/yixuanyang/Desktop/RawData/Force_HKY_pillar337.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF211  <- readLines("./data/211HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF214  <- readLines("./data/214HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF222  <- readLines("./data/222HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF223  <- readLines("./data/223HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF337  <- readLines("./data/337HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF479  <- readLines("./data/479HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF521  <- readLines("./data/521HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF526  <- readLines("./data/526HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF561  <- readLines("./data/561HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF735  <- readLines("./data/735HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF755  <- readLines("./data/755HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF852  <- readLines("./data/852HF/save/Force_HKY_01_02_nonclockqq_summary.txt",  n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF1050 <- readLines("./data/1050HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF1053 <- readLines("./data/1053HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF1215 <- readLines("./data/1215HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2129 <- readLines("./data/2129HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2158 <- readLines("./data/2158HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2210 <- readLines("./data/2210HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2214 <- readLines("./data/2214HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2321 <- readLines("./data/2321HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2358 <- readLines("./data/2358HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2371 <- readLines("./data/2371HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2382 <- readLines("./data/2382HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF2861 <- readLines("./data/2861HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3278 <- readLines("./data/3278HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3295 <- readLines("./data/3295HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3309 <- readLines("./data/3309HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3337 <- readLines("./data/3337HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3346 <- readLines("./data/3346HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3347 <- readLines("./data/3347HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3390 <- readLines("./data/3390HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF3994 <- readLines("./data/3994HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4025 <- readLines("./data/4025HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4031 <- readLines("./data/4031HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4063 <- readLines("./data/4063HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4268 <- readLines("./data/4268HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4287 <- readLines("./data/4287HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4494 <- readLines("./data/4494HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4553 <- readLines("./data/4553HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4570 <- readLines("./data/4570HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF4932 <- readLines("./data/4932HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF5153 <- readLines("./data/5153HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF5233 <- readLines("./data/5233HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF5316 <- readLines("./data/5316HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HF5550 <- readLines("./data/5550HF/save/Force_HKY_01_02_nonclockqq_summary.txt", n = 88) %>% as.numeric() %>% append(NA, after = 7)
HKY_Forced <- cbind(HF211, HF214, HF222, HF223, HF337, HF479, HF521, HF526, HF561, HF735, HF755, HF852, 
                   HF1050, HF1053, HF1215, HF2129, HF2158, HF2210, HF2214, HF2321, HF2358, HF2371, HF2382, 
                   HF2861, HF3278, HF3295, HF3309, HF3337, HF3346, HF3347, HF3390, HF3994, HF4025, HF4031, 
                   HF4063, HF4268, HF4287, HF4494, HF4553, HF4570, HF4932, HF5153, HF5233, HF5316, HF5550) 
rownames(HKY_Forced) <- NameList
```
# Table to see log-likelihood 
```{r MakeTable, echo=FALSE}
col <- c("MG_ll", "MG_tau", "MG_Force_ll", "Difference")
difference <- MG["ll",] - MG_Forced["ll",]
MG_Force_Form <- data.frame(MG["ll",], MG["tau",], MG_Forced["ll",], difference) # Difference is the difference between MG_ll with and without force tau
datatable(MG_Force_Form, colnames = col) %>% 
  formatRound( columns = 1:4 , 3) %>% 
  formatStyle('difference', 
              background = styleColorBar(MG_Force_Form$difference, 'lightblue'), 
              backgroundSize = '98% 88%', 
              backgroundRepeat = 'no-repeat',
              backgroundPosition = 'center')
```
## Correlation of ll
```{r, ll}
qplot(MG["ll",], MG_Forced["ll",] ) + geom_abline(slope = 1, intercept = 0)
```

# Proportion of post-duplication changes due to IGC (ignore branches that do not have duplication)
### IGCchanges function $\frac{\sum{1->2}+\sum{2->1}}{\sum{1->2}+\sum{2->1}+\sum{mutation}}$
```{r}
IGCchanges <- function(a, b, mutation){
  num <- colSums(a) + colSums(b)
  den <- num + colSums(mutation)
  num/den
}
total <- IGCchanges(MG[c(44:57),], MG[c(60:73),], MG[c(76:89),]) %>% data.frame()
# 44:57 60:73 76:89
datatable(total, colnames = "proportion") %>%
  formatRound( columns = 1 , 3)  %>% 
  formatStyle('.', 
              background = styleColorBar(total$., 'lightblue'), 
              backgroundSize = '98% 88%', 
              backgroundRepeat = 'no-repeat',
              backgroundPosition = 'center')
```
## Calculate proportion for each branch separately.  Plot those (ignore N0-N1 and ignore N0-outgroup)
```{r}
IGCchangesSep <- function(x){
  one <- paste("(", x, ",1->2)",sep = "")
  two <- paste("(", x, ",2->1)",sep = "")
  mut <- paste("(", x, ",mut)",sep = "")
  num <- MG[one,] + MG[two,]
  den <- num + MG[mut,]
  num/den
}
N1N3 <- IGCchangesSep("N1,N3") 
N1N2 <- IGCchangesSep("N1,N2") 
N3N6 <- IGCchangesSep("N3,N6") 
N3N4 <- IGCchangesSep("N3,N4") 
N6N7 <- IGCchangesSep("N6,N7") 
N4N5 <- IGCchangesSep("N4,N5")
N2ENSDARG <- IGCchangesSep("N2,ENSDARG") 
N2ENSAMXG <- IGCchangesSep("N2,ENSAMXG") 
N6ENSGACG <- IGCchangesSep("N6,ENSGACG") 
N4ENSONIG <- IGCchangesSep("N4,ENSONIG") 
N7ENSTRUG <- IGCchangesSep("N7,ENSTRUG") 
N7ENSTNIG <- IGCchangesSep("N7,ENSTNIG") 
N5ENSXMAG <- IGCchangesSep("N5,ENSXMAG") 
N5ENSORLG <- IGCchangesSep("N5,ENSORLG") 
```

```{r}
IGC_List1 <- data.frame(N1N3, N1N2, N3N6, N3N4, N6N7, N4N5)
IGC_List2 <- data.frame(N2ENSDARG, N2ENSAMXG, N6ENSGACG, N4ENSONIG, N7ENSTRUG, N7ENSTNIG, N5ENSXMAG, N5ENSORLG) 

datatable(IGC_List1, colnames = c("N1N3", "N1N2", "N3N6", "N3N4", "N6N7", "N4N5")) %>% 
  formatRound( columns = 1:6 , 3) %>% 
  formatStyle(colnames(IGC_List1)[1:ncol(IGC_List1)],
              background = styleColorBar(IGC_List1$N1N3, 'lightblue'), 
              backgroundSize = '98% 88%', 
              backgroundRepeat = 'no-repeat',
              backgroundPosition = 'center')
datatable(IGC_List2, colnames = c("N2ENSDARG", "N2ENSAMXG", "N6ENSGACG", "N4ENSONIG", "N7ENSTRUG", "N7ENSTNIG", "N5ENSXMAG", "N5ENSORLG")) %>% 
  formatRound( columns = 1:8 , 3) %>% 
  formatStyle(colnames(IGC_List2)[1:ncol(IGC_List2)],
              background = styleColorBar(IGC_List2$N2ENSDARG, 'lightblue'), 
              backgroundSize = '98% 88%', 
              backgroundRepeat = 'no-repeat',
              backgroundPosition = 'center')

```
### Comparing between each branch
#### This part is the average of IGC rate for each branch.
```{r}
tpList <- data.frame(N1N3, N1N2, N3N6, N3N4, N2ENSDARG, N2ENSAMXG, N6N7, N6ENSGACG, N4N5, N4ENSONIG, N7ENSTRUG, N7ENSTNIG, N5ENSXMAG, N5ENSORLG) %>% t()
BranchIGCmean <- data.frame(rowMeans(tpList))
datatable(BranchIGCmean, colnames = "average") %>% 
  formatRound( columns = 1 , 3) %>% 
  formatStyle(colnames(BranchIGCmean)[1:ncol(BranchIGCmean)],
              background = styleColorBar(BranchIGCmean$rowMeans.tpList., 'lightblue'), 
              backgroundSize = '98% 88%', 
              backgroundRepeat = 'no-repeat',
              backgroundPosition = 'center')
```

```{r}
averageTau <- rowMeans(MG[28:41,]) %>% data.frame()
datatable(averageTau, colnames = "average") %>% 
  formatRound( columns = 1 , 3) %>% 
  formatStyle(colnames(averageTau)[1:ncol(averageTau)],
              background = styleColorBar(averageTau$., 'lightblue'), 
              backgroundSize = '98% 88%', 
              backgroundRepeat = 'no-repeat',
              backgroundPosition = 'center')
```

## Plot of each branch
```{r}
PlotBranch <- function(x){
  one <- paste("(", x, ",1->2)",sep = "")
  two <- paste("(", x, ",2->1)",sep = "")
  mut <- paste("(", x, ",mut)",sep = "")
  num <- MG[one,] + MG[two,]
  den <- num + MG[mut,]
  s <- lm(num~den-1)
  class(s)
  #print(s$coefficients[1])
  qplot(den, num) + 
    geom_abline(slope = s$coefficients[1], intercept = 0) + 
    ggtitle(label = x, subtitle = paste("slope:", toString(s$coefficients[1]), sep = " "))
}
PlotBranch("N1,N3")
PlotBranch("N1,N2")
PlotBranch("N3,N6")
PlotBranch("N3,N4")
PlotBranch("N2,ENSDARG")
PlotBranch("N2,ENSAMXG")
PlotBranch("N6,N7")
PlotBranch("N6,ENSGACG")
PlotBranch("N4,N5")
PlotBranch("N4,ENSONIG")
PlotBranch("N7,ENSTRUG")
PlotBranch("N7,ENSTNIG")
PlotBranch("N5,ENSXMAG")
PlotBranch("N5,ENSORLG")
```
# Asymmetry
## For this part we want to see if there's asymmetry between branch 1->2 and 2->1.
```{r}
Asymmetry <- function(x){
  one <- paste("(", x, ",1->2)",sep = "")
  two <- paste("(", x, ",2->1)",sep = "")
  qplot(MG[one,], MG[two,], main = x) + geom_abline(slope = 1, intercept = 0) +
    labs(x="1->2", y="2->1")
}
Asymmetry("N1,N3")
Asymmetry("N1,N2")
Asymmetry("N3,N6")
Asymmetry("N3,N4")
Asymmetry("N2,ENSDARG")
Asymmetry("N2,ENSAMXG")
Asymmetry("N6,N7")
Asymmetry("N6,ENSGACG")
Asymmetry("N4,N5")
Asymmetry("N4,ENSONIG")
Asymmetry("N7,ENSTRUG")
Asymmetry("N7,ENSTNIG")
Asymmetry("N5,ENSXMAG")
Asymmetry("N5,ENSORLG")
```

# Is estimated value of omega for a gene correlated with the estimated value of tau?
```{r MakePlot}
TMG <- t(MG)
ot <- lm(MG["omega",]~MG["tau",])$coefficients
pearson <- cor(MG["omega",], MG["tau",], method = "pearson")
qplot(MG["omega",], MG["tau",]) + 
  geom_abline(slope = ot[2], intercept = ot[1]) + 
  labs(title = "omega vs tau", x="omega", y="tau", subtitle = paste("pearson:", pearson, "\nslope:    ", ot))



summary(lm(MG["omega",]~MG["tau",]))

summary(aov(MG["omega",]~MG["tau",]))

```

# For tau using ANOVA method $Y = \alpha_i + \beta_j + \epsilon$ 
```{r}
MGstau <- MG[28:41,] %>% 
  #log10() %>% 
  data.frame() %>% 
  rownames_to_column(var = "branch")
MGstau
new <- melt(MGstau, id.vars = "branch", value.name = "tau")
colnames(new)[colnames(new) == "variable"] <- "gene"
new
A <- aov(data = new, formula = tau~branch+gene)    # A for ANOVA output
summary(A)
```

```{r}
library(lme4)
library(Matrix)
data <- data.frame(MG)
scale0 <- colSums(MG[c(44:57, 60:73),]) # sum of 1 -> 2 and 2 -> 1
tau.encount <- colSums(MG[c(44:57, 60:73),]) * MG[1,]
data <- rbind(MG, scale0, tau.encount)
data <- data[c(1, 8, 28:41, 90, 91),]
```


Poisson calculation
```{r}
taucountmatrix <- MG[44:57,]+MG[60:73,]
scale0matrix <- taucountmatrix/MG[28:41,]
omegamatrix <- rbind(MG[8,], MG[8,], MG[8,], MG[8,],MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,], MG[8,])
rownames(omegamatrix) <- rownames(MG[12:25,])
rownames(scale0matrix) <- rownames(MG[12:25,])
rownames(taucountmatrix) <- rownames(MG[12:25,])

newmatrix=matrix(rep(1,14*45),nrow=14)
for(i in 1:14){
  newmatrix[i,]=scale0matrix[i,]/MG[1,]
}
newmatrix=newmatrix/MG[12:25,]

genenamesmatrix <- rbind(colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix),colnames(taucountmatrix), colnames(taucountmatrix),colnames(taucountmatrix) )
branchnamesmatrix <- cbind(rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix), rownames(taucountmatrix))
taucountvector <- c(taucountmatrix)
scale0vector <- c(scale0matrix)
omegavector <- c(omegamatrix)
genenamesvector <- c(genenamesmatrix)
branchnamesvector <- c(branchnamesmatrix)

data=data.frame(IGCevent=taucountvector,scale0=log(scale0vector),omega=omegavector,genename=genenamesvector,
               branchname=branchnamesvector, seqdiff=c(newmatrix ))

library(lme4)
glm(round(IGCevent)~scale0+genename+seqdiff+seqdiff*genename,data=data,family = "poisson")
glm(IGCevent~scale0+branchname+genename,data=data,family = poisson)
```




















